{ "openapi": "3.0.0", "info": { "title": "FindAPhD Search API", "version": "1.0.0", "description": "دسترسی کامل به جستجوی موقعیت‌های دکترا از FindAPhD.com از طریق RESTful API", "contact": { "name": "API Support", "email": "support@example.com" }, "license": { "name": "ISC", "url": "https://opensource.org/licenses/ISC" } }, "servers": [{ "url": "http://91.99.13.17/api", "description": "Development Server" }, { "url": "https://api.yourdomain.com/api", "description": "Production Server" }], "tags": [{ "name": "Health", "description": "وضعیت و سلامت سرویس" }, { "name": "Session", "description": "مدیریت Session کاربران" }, { "name": "Search", "description": "عملیات جستجو و دریافت نتایج" }], "paths": { "/health": { "get": { "tags": ["Health"], "summary": "بررسی وضعیت کلی سرویس", "description": "دریافت اطلاعات کامل وضعیت سرویس، browser pool، sessions و مصرف حافظه", "operationId": "getHealth", "responses": { "200": { "description": "وضعیت سالم", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HealthResponse" }, "example": { "status": "healthy", "timestamp": "2025-10-05T12:00:00.000Z", "uptime": 3600, "browser": { "maxTabs": 100, "activeTabs": 5, "activeSessions": 2, "queueLength": 0, "availableTabs": 95 }, "sessions": { "totalSessions": 10, "totalUsers": 5, "activeSessions": 3 }, "memory": { "used": 256, "total": 512 } } } } } } } }, "/health/ready": { "get": { "tags": ["Health"], "summary": "بررسی آماده بودن برای دریافت درخواست", "description": "چک می‌کند که آیا سرویس آماده پردازش درخواست جدید است یا نه", "operationId": "getReady", "responses": { "200": { "description": "سرویس آماده است", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ReadyResponse" } } } }, "503": { "description": "سرویس آماده نیست", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } } } } }, "/session": { "post": { "tags": ["Session"], "summary": "ایجاد session جدید", "description": "ایجاد یک session جدید برای کاربر", "operationId": "createSession", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateSessionRequest" }, "example": { "userId": "user-123" } } } }, "responses": { "200": { "description": "Session با موفقیت ایجاد شد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SessionResponse" } } } }, "400": { "description": "درخواست نامعتبر", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } } } } }, "/session/{sessionId}": { "get": { "tags": ["Session"], "summary": "دریافت اطلاعات session", "description": "دریافت اطلاعات کامل یک session", "operationId": "getSession", "parameters": [{ "name": "sessionId", "in": "path", "required": true, "description": "شناسه یکتای session", "schema": { "type": "string", "format": "uuid" } }], "responses": { "200": { "description": "اطلاعات session", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SessionDetailResponse" } } } }, "404": { "description": "Session یافت نشد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } } } }, "delete": { "tags": ["Session"], "summary": "حذف session", "description": "حذف یک session و تمام داده‌های مرتبط با آن", "operationId": "deleteSession", "parameters": [{ "name": "sessionId", "in": "path", "required": true, "description": "شناسه یکتای session", "schema": { "type": "string", "format": "uuid" } }], "responses": { "200": { "description": "Session با موفقیت حذف شد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SuccessMessage" } } } }, "404": { "description": "Session یافت نشد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } } } } }, "/session/user/{userId}": { "get": { "tags": ["Session"], "summary": "دریافت تمام session های یک کاربر", "description": "لیست تمام session های فعال یک کاربر", "operationId": "getUserSessions", "parameters": [{ "name": "userId", "in": "path", "required": true, "description": "شناسه یکتای کاربر", "schema": { "type": "string" } }], "responses": { "200": { "description": "لیست session ها", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UserSessionsResponse" } } } } } } }, "/search": { "post": { "tags": ["Search"], "summary": "انجام جستجوی جدید", "description": "جستجوی موقعیت‌های دکترا با کلیدواژه و فیلترهای مختلف", "operationId": "performSearch", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchRequest" }, "examples": { "simple": { "summary": "جستجوی ساده", "value": { "userId": "user-123", "keywords": "artificial intelligence", "page": 1 } }, "withFilters": { "summary": "جستجو با فیلتر", "value": { "userId": "user-123", "sessionId": "session-uuid", "keywords": "machine learning", "filters": { "discipline": "10M7g0", "geography": ["g0w900"], "funding": ["01M0"] }, "page": 1 } }, "complexSearch": { "summary": "جستجوی پیشرفته", "value": { "userId": "user-123", "sessionId": "session-uuid", "keywords": "quantum computing", "filters": { "discipline": "10M7g0", "subject": "30M7g2t1", "geography": ["g0w900", "g0Mw00"], "funding": ["01M0", "0100"] }, "page": 1 } } } } } }, "responses": { "200": { "description": "جستجو با موفقیت انجام شد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchResponse" } } } }, "400": { "description": "درخواست نامعتبر", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } }, "500": { "description": "خطای سرور", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } } } } }, "/search/{searchId}": { "get": { "tags": ["Search"], "summary": "دریافت نتایج جستجو", "description": "دریافت وضعیت و نتایج یک جستجو", "operationId": "getSearchResults", "parameters": [{ "name": "searchId", "in": "path", "required": true, "description": "شناسه یکتای جستجو", "schema": { "type": "string", "format": "uuid" } }, { "name": "sessionId", "in": "query", "required": true, "description": "شناسه session", "schema": { "type": "string", "format": "uuid" } }], "responses": { "200": { "description": "نتایج جستجو", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchResultResponse" } } } }, "404": { "description": "جستجو یافت نشد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Error" } } } } } } }, "/search/{searchId}/continue": { "post": { "tags": ["Search"], "summary": "ادامه جستجو (صفحه بعدی)", "description": "ادامه دادن جستجو برای دریافت صفحات بعدی", "operationId": "continueSearch", "parameters": [{ "name": "searchId", "in": "path", "required": true, "description": "شناسه جستجو", "schema": { "type": "string", "format": "uuid" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ContinueSearchRequest" } } } }, "responses": { "200": { "description": "صفحه جدید با موفقیت دریافت شد", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchResponse" } } } } } } }, "/search/history/{sessionId}": { "get": { "tags": ["Search"], "summary": "دریافت تاریخچه جستجوها", "description": "لیست تمام جستجوهای انجام شده در یک session", "operationId": "getSearchHistory", "parameters": [{ "name": "sessionId", "in": "path", "required": true, "description": "شناسه session", "schema": { "type": "string", "format": "uuid" } }], "responses": { "200": { "description": "تاریخچه جستجوها", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchHistoryResponse" } } } } } } }, "/search/filters/available": { "post": { "tags": ["Search"], "summary": "دریافت فیلترهای موجود", "description": "لیست تمام فیلترهای قابل استفاده در جستجو", "operationId": "getAvailableFilters", "responses": { "200": { "description": "لیست فیلترها", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/FiltersResponse" } } } } } } } }, "components": { "schemas": { "HealthResponse": { "type": "object", "properties": { "status": { "type": "string", "enum": ["healthy", "unhealthy"] }, "timestamp": { "type": "string", "format": "date-time" }, "uptime": { "type": "number", "description": "زمان اجرای سرویس به ثانیه" }, "browser": { "$ref": "#/components/schemas/BrowserPoolStats" }, "sessions": { "$ref": "#/components/schemas/SessionStats" }, "memory": { "$ref": "#/components/schemas/MemoryStats" } } }, "ReadyResponse": { "type": "object", "properties": { "ready": { "type": "boolean" }, "availableTabs": { "type": "integer" }, "queueLength": { "type": "integer" } } }, "BrowserPoolStats": { "type": "object", "properties": { "maxTabs": { "type": "integer" }, "activeTabs": { "type": "integer" }, "activeSessions": { "type": "integer" }, "queueLength": { "type": "integer" }, "availableTabs": { "type": "integer" } } }, "SessionStats": { "type": "object", "properties": { "totalSessions": { "type": "integer" }, "totalUsers": { "type": "integer" }, "activeSessions": { "type": "integer" } } }, "MemoryStats": { "type": "object", "properties": { "used": { "type": "integer", "description": "حافظه استفاده شده (MB)" }, "total": { "type": "integer", "description": "کل حافظه (MB)" } } }, "CreateSessionRequest": { "type": "object", "required": ["userId"], "properties": { "userId": { "type": "string", "description": "شناسه یکتای کاربر" } } }, "SessionResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "data": { "type": "object", "properties": { "sessionId": { "type": "string", "format": "uuid" }, "userId": { "type": "string" }, "createdAt": { "type": "integer", "description": "timestamp ایجاد" } } } } }, "SessionDetailResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "data": { "type": "object", "properties": { "sessionId": { "type": "string" }, "userId": { "type": "string" }, "createdAt": { "type": "integer" }, "lastAccessedAt": { "type": "integer" }, "searchCount": { "type": "integer" }, "currentSearch": { "type": "object", "nullable": true } } } } }, "UserSessionsResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "data": { "type": "array", "items": { "type": "object", "properties": { "sessionId": { "type": "string" }, "createdAt": { "type": "integer" }, "lastAccessedAt": { "type": "integer" }, "searchCount": { "type": "integer" } } } } } }, "SearchRequest": { "type": "object", "required": ["userId"], "properties": { "userId": { "type": "string", "description": "شناسه کاربر" }, "sessionId": { "type": "string", "format": "uuid", "description": "شناسه session (اختیاری - اگر نباشد ایجاد می‌شود)" }, "keywords": { "type": "string", "description": "کلیدواژه‌های جستجو" }, "filters": { "$ref": "#/components/schemas/SearchFilters" }, "page": { "type": "integer", "minimum": 1, "default": 1 } } }, "SearchFilters": { "type": "object", "properties": { "discipline": { "type": "string", "description": "توکن رشته تحصیلی (مثلاً 10M7g0 برای Computer Science)" }, "subject": { "type": "string", "description": "توکن موضوع (مثلاً 30M7g2t1 برای AI)" }, "geography": { "type": "array", "items": { "type": "string" }, "description": "آرایه توکن‌های مکان (مثلاً g0w900 برای UK)" }, "funding": { "type": "array", "items": { "type": "string" }, "description": "آرایه توکن‌های تامین مالی (مثلاً 01M0 برای Self-funded)" }, "institution": { "type": "string", "description": "توکن موسسه" }, "phdType": { "type": "string", "description": "توکن نوع دوره" }, "studyMode": { "type": "string", "description": "توکن شیوه تحصیل" } } }, "SearchResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "sessionId": { "type": "string" }, "searchId": { "type": "string" }, "status": { "type": "string", "enum": ["pending", "in-progress", "completed", "error"] }, "data": { "$ref": "#/components/schemas/SearchData" } } }, "SearchData": { "type": "object", "properties": { "id": { "type": "string" }, "query": { "type": "string" }, "filters": { "$ref": "#/components/schemas/SearchFilters" }, "status": { "type": "string" }, "currentPage": { "type": "integer" }, "totalPages": { "type": "integer", "nullable": true }, "results": { "type": "array", "items": { "$ref": "#/components/schemas/PhDResult" } }, "fromCache": { "type": "boolean" }, "createdAt": { "type": "integer" }, "updatedAt": { "type": "integer" } } }, "PhDResult": { "type": "object", "properties": { "title": { "type": "string" }, "url": { "type": "string", "format": "uri" }, "institution": { "type": "string" }, "location": { "type": "string" }, "discipline": { "type": "string" }, "funding": { "type": "string" }, "publishedDate": { "type": "string" }, "description": { "type": "string" }, "studyType": { "type": "string" }, "position": { "type": "integer" } } }, "SearchResultResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "data": { "$ref": "#/components/schemas/SearchData" } } }, "ContinueSearchRequest": { "type": "object", "required": ["sessionId"], "properties": { "sessionId": { "type": "string" }, "page": { "type": "integer", "minimum": 1 } } }, "SearchHistoryResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "data": { "type": "array", "items": { "$ref": "#/components/schemas/SearchData" } } } }, "FiltersResponse": { "type": "object", "properties": { "success": { "type": "boolean" }, "data": { "type": "object", "properties": { "disciplines": { "type": "array", "items": { "$ref": "#/components/schemas/FilterOption" } }, "subjects": { "type": "array", "items": { "$ref": "#/components/schemas/FilterOption" } }, "geographies": { "type": "array", "items": { "$ref": "#/components/schemas/FilterOption" } }, "funding": { "type": "array", "items": { "$ref": "#/components/schemas/FilterOption" } } } } } }, "FilterOption": { "type": "object", "properties": { "token": { "type": "string" }, "name": { "type": "string" }, "slug": { "type": "string" } } }, "SuccessMessage": { "type": "object", "properties": { "success": { "type": "boolean" }, "message": { "type": "string" } } }, "Error": { "type": "object", "properties": { "error": { "type": "string" }, "requestId": { "type": "string" } } } } } }